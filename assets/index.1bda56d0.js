const E=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};E();const w=e=>{const n=document.createElement("canvas"),t=n.getContext("2d");return{element:n,context:t,setSize(o,s){this.element.width=o,this.element.height=s}}},r=(e=0,n=0)=>({x:e,y:n,add(t){return r(this.x+t.x,this.y+t.y)},angle(){return Math.atan2(this.y,this.x)},angleToPoint(t){return t.sub(this).angle()},distanceTo(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},dot(t){return this.x*t.x+this.y*t.y},length(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize(){let t=this.length();t!=0&&(this.x/=t,this.y/=t)},normalized(){return this.normalize(),this},scalar(t){return r(this.x*t,this.y*t)},sub(t){return r(this.x-t.x,this.y-t.y)}}),d=(e,n,t,o)=>({radius:e,speed:n,color:t,position:o,velocity:r(),render(s){s.beginPath(),s.arc(this.position.x,this.position.y,this.radius,0,2*Math.PI,0),s.fillStyle=this.color,s.shadowColor=this.color,s.fill(),s.closePath()}}),v=15,L=900,M=1.5,g="#FF0",P=(e,n)=>{const t=d(v,L,g,e);return t.lifeTime=M,t.direction=e.angleToPoint(n),t.velocity=r(Math.cos(t.direction),Math.sin(t.direction)),t.velocity=t.velocity.scalar(t.speed),t.update=o=>{t.lifeTime-=o,t.position=t.position.add(t.velocity.scalar(o))},t.draw=o=>t.render(o),t},c={position:r(innerWidth/2,innerHeight/2),isDown:!1},u={w:!1,a:!1,s:!1,d:!1},l=(()=>({isDown(e){return u[e]},setDown(e){u[e]=!0},setUp(e){u[e]=!1},setMousePositon(e,n){c.position=r(e,n)},getMousePosition(){return c.position},setMouseDown(){c.isDown=!0},setMouseUp(){c.isDown=!1},mouseIsDown(){return c.isDown}}))(),h=30,S=.25/2,A=r(innerWidth/2-h,innerHeight/2-h),D=300,I="#FF0",p={w:r(0,-1),s:r(0,1),d:r(1,0),a:r(-1,0)},T=e=>e.lifeTime>0,R=()=>{const e=d(h,D,I,A);return e.bullets=[],e.lastShot=null,e.move=n=>{for(let t in p)l.isDown(t)&&(e.velocity=e.velocity.add(p[t]));e.velocity=e.velocity.normalized().scalar(e.speed),e.position=e.position.add(e.velocity.scalar(n)),e.velocity=r()},e.shoot=()=>{let n=performance.now()*.001;if(e.lastShot===null&&(e.lastShoot=n),l.mouseIsDown()){let t=l.getMousePosition(),o=r(e.position.x,e.position.y);if(n-e.lastShot>S){let s=P(o,t);e.bullets.push(s),e.lastShot=n}}},e.updateBullets=n=>{e.bullets.forEach(t=>{t.update(n)}),e.bullets=e.bullets.filter(T)},e.renderBullets=n=>{e.bullets.forEach(t=>{t.render(n)})},e.update=n=>{e.move(n),e.shoot(),e.updateBullets(n)},e.draw=n=>{e.render(n),e.renderBullets(n)},e},_=30,b=150,x="#FF0",C=e=>{const n=d(_,b,x,e);return n.isAlive=!0,n.velocity=r(),n.update=(t,o)=>{let s=n.position.angleToPoint(o);n.velocity=r(Math.cos(s),Math.sin(s)),n.velocity=n.velocity.scalar(n.speed).scalar(t),n.position=n.position.add(n.velocity)},n.draw=t=>n.render(t),n},N=(()=>({randomInRange(e=0,n=1){return Math.random()*(n-e)+e}}))(),y=1,f=1500,O=1.01,U=e=>e.isAlive,Y=()=>{const e=R();let n=[],t=y,o=y;return{player:e,spawnEnemy(){let s=N.randomInRange(0,2*Math.PI),i=r(f*Math.cos(s),f*Math.sin(s));n.push(C(i))},checkSpawnEnemy(s){t-=s,t<=0&&(this.spawnEnemy(),t=o,o/=O)},checkBulletCollision(){n.forEach(s=>{s.isAlive&&e.bullets.forEach(i=>{s.position.distanceTo(i.position)<=i.radius+s.radius&&(i.lifeTime=0,s.isAlive=!1)})})},update(s){this.checkSpawnEnemy(s),this.checkBulletCollision(),n=n.filter(U),n.forEach(i=>{i.update(s,e.position)}),e.update(s)},draw(s){s.clearRect(0,0,window.innerWidth,window.innerHeight),n.forEach(i=>{i.draw(s)}),this.player.draw(s)}}},B=({key:e})=>l.setDown(e),F=({key:e})=>l.setUp(e),k=({clientX:e,clientY:n})=>{l.setMousePositon(e,n)},z=()=>l.setMouseDown(),W=()=>l.setMouseUp();(function(){const n=document.querySelector("#app"),t=w(),o=Y();let s=null;t.setSize(innerWidth,innerHeight),n.appendChild(t.element);const i=a=>{s===null&&(s=a);const m=(a-s)*.001;s=a,o.update(m),o.draw(t.context),window.requestAnimationFrame(i)};window.requestAnimationFrame(i),window.addEventListener("resize",()=>{t.setSize(innerWidth,innerHeight)}),window.addEventListener("keydown",B),window.addEventListener("keyup",F),window.addEventListener("mousemove",k),window.addEventListener("mousedown",z),window.addEventListener("mouseup",W)})();
