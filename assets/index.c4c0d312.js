const v=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}};v();const L=e=>{const s=document.createElement("canvas"),t=s.getContext("2d");return{element:s,context:t,setSize(r,i){this.element.width=r,this.element.height=i}}},l=(e=0,s=0)=>({x:e,y:s,add(t){return l(this.x+t.x,this.y+t.y)},angle(){return Math.atan2(this.y,this.x)},angleToPoint(t){return t.sub(this).angle()},distanceTo(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},dot(t){return this.x*t.x+this.y*t.y},length(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize(){let t=this.length();t!=0&&(this.x/=t,this.y/=t)},normalized(){return this.normalize(),this},scalar(t){return l(this.x*t,this.y*t)},sub(t){return l(this.x-t.x,this.y-t.y)}}),h=(e,s,t,r,i)=>({radius:e,speed:s,color:t,blur:r,position:i,velocity:l(),render(o){o.beginPath(),o.arc(this.position.x,this.position.y,this.radius,0,2*Math.PI,0),o.fillStyle=this.color,o.shadowColor=this.color,o.shadowBlur=this.blur,o.fill(),o.closePath()}}),S=15,g=5,A=700,T=1.5,M="#ffdd59",R=(e,s)=>{const t=h(S,A,M,g,e);return t.lifeTime=T,t.direction=e.angleToPoint(s),t.velocity=l(Math.cos(t.direction),Math.sin(t.direction)),t.velocity=t.velocity.scalar(t.speed),t.update=r=>{t.lifeTime-=r,t.position=t.position.add(t.velocity.scalar(r))},t.draw=r=>t.render(r),t},d={position:l(innerWidth/2,innerHeight/2),isDown:!1},f={w:!1,a:!1,s:!1,d:!1,Escape:!1},c=(()=>({isDown(e){return f[e]},setDown(e){f[e]=!0},setUp(e){f[e]=!1},setMousePositon(e,s){d.position=l(e,s)},getMousePosition(){return d.position},setMouseDown(){d.isDown=!0},setMouseUp(){d.isDown=!1},mouseIsDown(){return d.isDown}}))(),p=30,D=15,I=10,_=.25/2,b=l(innerWidth/2-p,innerHeight/2-p),B=300,Y="#ffdd59",E={w:l(0,-1),s:l(0,1),d:l(1,0),a:l(-1,0)},C=e=>e.lifeTime>0,w=()=>{const e=h(p,B,Y,D,b);return e.bullets=[],e.lastShot=null,e.health=I,e.isAlive=!0,e.score=0,e.increaseScore=()=>{e.score++},e.damage=()=>{if(e.health<=0){e.isAlive=!1;return}e.health--},e.move=s=>{for(let t in E)c.isDown(t)&&(e.velocity=e.velocity.add(E[t]));e.velocity=e.velocity.normalized().scalar(e.speed),e.position=e.position.add(e.velocity.scalar(s)),e.velocity=l()},e.shoot=()=>{let s=performance.now()*.001;if(e.lastShot===null&&(e.lastShoot=s),c.mouseIsDown()){let t=c.getMousePosition(),r=l(e.position.x,e.position.y);if(s-e.lastShot>_){let i=R(r,t);e.bullets.push(i),e.lastShot=s}}},e.updateBullets=s=>{e.bullets.forEach(t=>{t.update(s)}),e.bullets=e.bullets.filter(C)},e.renderBullets=s=>{e.bullets.forEach(t=>{t.render(s)})},e.update=s=>{e.move(s),e.shoot(),e.updateBullets(s)},e.draw=s=>{e.render(s),e.renderBullets(s)},e},U=30,N=15,O=150,k="#ff4757",x=e=>{const s=h(U,O,k,N,e);return s.isAlive=!0,s.velocity=l(),s.update=(t,r)=>{let i=s.position.angleToPoint(r);s.velocity=l(Math.cos(i),Math.sin(i)),s.velocity=s.velocity.scalar(s.speed).scalar(t),s.position=s.position.add(s.velocity)},s.draw=t=>s.render(t),s},y=(e,s="#FFF",t=0,r)=>({value:e,color:s,blur:t,position:r,render(i){i.fillStyle=this.color,i.shadowColor=this.color,i.shadowBlur=this.blur,i.font="22px 'Press Start 2P'",i.fillText(this.value,this.position.x,this.position.y)}}),H=(()=>({draw(e,s,t){let r=y(`Health: ${s}`,"#ffdd59",0,l(30,80)),i=y(`Score: ${t}`,"#ffdd59",1,l(30,120));r.render(e),i.render(e)}}))(),F=(()=>({randomInRange(e=0,s=1){return Math.random()*(s-e)+e}}))(),u=1,m=1500,W=1.01,z=1/2,K=e=>e.isAlive,q=()=>{let e=w(),s=[],t=u,r=u,i=!1,o=null;return{player:e,spawnEnemy(){let n=F.randomInRange(0,2*Math.PI),a=l(m*Math.cos(n),m*Math.sin(n));s.push(x(a))},checkSpawnEnemy(n){t-=n,t<=0&&(this.spawnEnemy(),t=r,r/=W)},checkBulletCollision(){s.forEach(n=>{n.isAlive&&e.bullets.forEach(a=>{n.position.distanceTo(a.position)<=a.radius+n.radius&&(a.lifeTime=0,n.isAlive=!1,e.increaseScore())})})},checkPlayerCollision(){s.forEach(n=>{n.isAlive&&n.position.distanceTo(e.position)<=e.radius+n.radius&&(e.damage(),n.isAlive=!1)})},checkKeyPressed(){if(c.isDown("Escape")){let n=performance.now()*.001;o===null&&(o=n),n-o>z&&(i=!i,o=n)}},restart(){e=w(),s=[],t=u,r=u,isPause=!1},update(n){this.checkKeyPressed(),!i&&(this.checkSpawnEnemy(n),this.checkBulletCollision(),this.checkPlayerCollision(),s=s.filter(K),s.forEach(a=>{a.update(n,e.position)}),e.update(n))},drawPaused(n){let a=l(innerWidth/2-400,innerHeight/2),P=y("Game Paused (Press esc to continue)","#000",0,a);n.fillRect(0,0,innerWidth,innerHeight),P.render(n)},draw(n){if(n.clearRect(0,0,window.innerWidth,window.innerHeight),s.forEach(a=>{a.draw(n)}),e.draw(n),H.draw(n,e.health,e.score),i){this.drawPaused(n);return}}}},G=({key:e})=>c.setDown(e),$=({key:e})=>c.setUp(e),X=({clientX:e,clientY:s})=>{c.setMousePositon(e,s)},j=()=>c.setMouseDown(),J=()=>c.setMouseUp();(function(){const s=document.querySelector("#app"),t=L(),r=q();let i=null;t.setSize(innerWidth,innerHeight),s.appendChild(t.element);const o=n=>{i===null&&(i=n);const a=(n-i)*.001;i=n,r.update(a),r.draw(t.context),window.requestAnimationFrame(o)};window.requestAnimationFrame(o),window.addEventListener("resize",()=>{t.setSize(innerWidth,innerHeight)}),window.addEventListener("keydown",G),window.addEventListener("keyup",$),window.addEventListener("mousemove",X),window.addEventListener("mousedown",j),window.addEventListener("mouseup",J)})();
