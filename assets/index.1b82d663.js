const w=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}};w();const m=e=>{const i=document.createElement("canvas"),t=i.getContext("2d");return{element:i,context:t,setSize(n,s){this.element.width=n,this.element.height=s}}},r=(e=0,i=0)=>({x:e,y:i,add(t){return r(this.x+t.x,this.y+t.y)},angle(){return Math.atan2(this.y,this.x)},angleToPoint(t){return t.sub(this).angle()},distanceTo(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},dot(t){return this.x*t.x+this.y*t.y},length(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize(){let t=this.length();t!=0&&(this.x/=t,this.y/=t)},normalized(){return this.normalize(),this},scalar(t){return r(this.x*t,this.y*t)},sub(t){return r(this.x-t.x,this.y-t.y)}}),d=(e,i,t,n,s)=>({radius:e,speed:i,color:t,blur:n,position:s,velocity:r(),render(o){o.beginPath(),o.arc(this.position.x,this.position.y,this.radius,0,2*Math.PI,0),o.fillStyle=this.color,o.shadowColor=this.color,o.shadowBlur=this.blur,o.fill(),o.closePath()}}),v=15,L=5,P=700,A=1.5,M="#ffdd59",g=(e,i)=>{const t=d(v,P,M,L,e);return t.lifeTime=A,t.direction=e.angleToPoint(i),t.velocity=r(Math.cos(t.direction),Math.sin(t.direction)),t.velocity=t.velocity.scalar(t.speed),t.update=n=>{t.lifeTime-=n,t.position=t.position.add(t.velocity.scalar(n))},t.draw=n=>t.render(n),t},c={position:r(innerWidth/2,innerHeight/2),isDown:!1},u={w:!1,a:!1,s:!1,d:!1},l=(()=>({isDown(e){return u[e]},setDown(e){u[e]=!0},setUp(e){u[e]=!1},setMousePositon(e,i){c.position=r(e,i)},getMousePosition(){return c.position},setMouseDown(){c.isDown=!0},setMouseUp(){c.isDown=!1},mouseIsDown(){return c.isDown}}))(),h=30,T=15,S=10,I=.25/2,R=r(innerWidth/2-h,innerHeight/2-h),D=300,_="#ffdd59",f={w:r(0,-1),s:r(0,1),d:r(1,0),a:r(-1,0)},b=e=>e.lifeTime>0,B=()=>{const e=d(h,D,_,T,R);return e.bullets=[],e.lastShot=null,e.health=S,e.isAlive=!0,e.damage=()=>{if(e.health<=0){e.isAlive=!1;return}e.health--},e.move=i=>{for(let t in f)l.isDown(t)&&(e.velocity=e.velocity.add(f[t]));e.velocity=e.velocity.normalized().scalar(e.speed),e.position=e.position.add(e.velocity.scalar(i)),e.velocity=r()},e.shoot=()=>{let i=performance.now()*.001;if(e.lastShot===null&&(e.lastShoot=i),l.mouseIsDown()){let t=l.getMousePosition(),n=r(e.position.x,e.position.y);if(i-e.lastShot>I){let s=g(n,t);e.bullets.push(s),e.lastShot=i}}},e.updateBullets=i=>{e.bullets.forEach(t=>{t.update(i)}),e.bullets=e.bullets.filter(b)},e.renderBullets=i=>{e.bullets.forEach(t=>{t.render(i)})},e.update=i=>{e.move(i),e.shoot(),e.updateBullets(i)},e.draw=i=>{e.render(i),e.renderBullets(i)},e},C=30,U=15,N=150,Y="#ff4757",O=e=>{const i=d(C,N,Y,U,e);return i.isAlive=!0,i.velocity=r(),i.update=(t,n)=>{let s=i.position.angleToPoint(n);i.velocity=r(Math.cos(s),Math.sin(s)),i.velocity=i.velocity.scalar(i.speed).scalar(t),i.position=i.position.add(i.velocity)},i.draw=t=>i.render(t),i},x=(e,i="#FFF",t=0,n)=>({value:e,color:i,blur:t,position:n,render(s){s.fillStyle=this.color,s.shadowColor=this.color,s.shadowBlur=this.blur,s.font="22px 'Press Start 2P'",s.fillText(this.value,this.position.x,this.position.y)}}),k=(()=>({draw(e,i){x(`Health: ${i}`,"#ffdd59",0,r(30,80)).render(e)}}))(),H=(()=>({randomInRange(e=0,i=1){return Math.random()*(i-e)+e}}))(),p=1,y=1500,F=1.01,z=e=>e.isAlive,W=()=>{const e=B();let i=[],t=p,n=p;return{player:e,spawnEnemy(){let s=H.randomInRange(0,2*Math.PI),o=r(y*Math.cos(s),y*Math.sin(s));i.push(O(o))},checkSpawnEnemy(s){t-=s,t<=0&&(this.spawnEnemy(),t=n,n/=F)},checkBulletCollision(){i.forEach(s=>{s.isAlive&&e.bullets.forEach(o=>{s.position.distanceTo(o.position)<=o.radius+s.radius&&(o.lifeTime=0,s.isAlive=!1)})})},checkPlayerCollision(){i.forEach(s=>{s.isAlive&&s.position.distanceTo(e.position)<=e.radius+s.radius&&(e.damage(),s.isAlive=!1)})},update(s){this.checkSpawnEnemy(s),this.checkBulletCollision(),this.checkPlayerCollision(),i=i.filter(z),i.forEach(o=>{o.update(s,e.position)}),e.update(s)},draw(s){s.clearRect(0,0,window.innerWidth,window.innerHeight),i.forEach(o=>{o.draw(s)}),e.draw(s),k.draw(s,e.health)}}},q=({key:e})=>l.setDown(e),K=({key:e})=>l.setUp(e),G=({clientX:e,clientY:i})=>{l.setMousePositon(e,i)},X=()=>l.setMouseDown(),$=()=>l.setMouseUp();(function(){const i=document.querySelector("#app"),t=m(),n=W();let s=null;t.setSize(innerWidth,innerHeight),i.appendChild(t.element);const o=a=>{s===null&&(s=a);const E=(a-s)*.001;s=a,n.update(E),n.draw(t.context),window.requestAnimationFrame(o)};window.requestAnimationFrame(o),window.addEventListener("resize",()=>{t.setSize(innerWidth,innerHeight)}),window.addEventListener("keydown",q),window.addEventListener("keyup",K),window.addEventListener("mousemove",G),window.addEventListener("mousedown",X),window.addEventListener("mouseup",$)})();
